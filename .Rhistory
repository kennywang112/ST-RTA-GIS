filter(Group %in% B_order) %>%
mutate(Group = factor(Group, levels = B_order)) %>%
ggplot(aes(x = reorder(Feature, Value), y = Value, fill = Group)) +
geom_col(position = "dodge") +
coord_flip() +
labs(title = "Broken Group Analysis")
all_features_mean <- final_data_for_tree %>%
group_by(Group_Label) %>%
summarise(across(where(is.numeric), \(x) mean(x, na.rm = TRUE))) %>%
ungroup()
all_features_mean$Group_Label%>%unique()
comparison_table <- all_features_mean %>%
pivot_longer(
cols = -Group_Label,
names_to = "Feature",
values_to = "Mean_Value"
) %>%
pivot_wider(
names_from = Group_Label,
values_from = "Mean_Value"
)
l <- c('bn_feature', 'lr_feature', 'hotspot', 'no_lane')
final_table <- comparison_table %>%
filter(!Feature %in% l)%>%
mutate(diff_val = abs(Broken_Overlap - Resilient_Overlap))%>%
arrange(desc(diff_val))%>%
head(20) %>%
# select(Feature, Broken_Overlap, Resilient_Overlap) %>%
pivot_longer(cols = -Feature, names_to = "Group", values_to = "Value")
final_table$Group%>%unique()
B_order <- c("Broken", "Broken_Overlap", "Broken_Neighbors")
R_order <- c("Resilient", "Resilient_Overlap", "Resilient_Neighbors")
final_table %>%
filter(Group %in% R_order) %>%
mutate(Group = factor(Group, levels = R_order)) %>%
ggplot(aes(x = reorder(Feature, Value), y = Value, fill = Group)) +
geom_col(position = "dodge") +
coord_flip() +
labs(title = "Broken Group Analysis")
final_table %>%
filter(Group %in% B_order) %>%
mutate(Group = factor(Group, levels = B_order)) %>%
ggplot(aes(x = reorder(Feature, Value), y = Value, fill = Group)) +
geom_col(position = "dodge") +
coord_flip() +
labs(title = "Broken Group Analysis")
final_table %>%
filter(Group %in% R_order) %>%
mutate(Group = factor(Group, levels = R_order)) %>%
ggplot(aes(x = reorder(Feature, Value), y = Value, fill = Group)) +
geom_col(position = "dodge") +
coord_flip() +
labs(title = "Resilient Group")
final_table %>%
filter(Group %in% B_order) %>%
mutate(Group = factor(Group, levels = B_order)) %>%
ggplot(aes(x = reorder(Feature, Value), y = Value, fill = Group)) +
geom_col(position = "dodge") +
coord_flip() +
labs(title = "Broken Group")
all_features_mean <- final_data_for_tree %>%
group_by(Group_Label) %>%
summarise(across(where(is.numeric), \(x) mean(x, na.rm = TRUE))) %>%
ungroup()
all_features_mean$Group_Label%>%unique()
comparison_table <- all_features_mean %>%
pivot_longer(
cols = -Group_Label,
names_to = "Feature",
values_to = "Mean_Value"
) %>%
pivot_wider(
names_from = Group_Label,
values_from = "Mean_Value"
)
l <- c('bn_feature', 'lr_feature', 'hotspot', 'no_lane')
final_table <- comparison_table %>%
filter(!Feature %in% l)%>%
mutate(diff_val = abs(Broken - Resilient))%>%
arrange(desc(diff_val))%>%
head(20) %>%
# select(Feature, Broken_Overlap, Resilient_Overlap) %>%
pivot_longer(cols = -Feature, names_to = "Group", values_to = "Value")
final_table$Group%>%unique()
B_order <- c("Broken", "Broken_Overlap", "Broken_Neighbors")
R_order <- c("Resilient", "Resilient_Overlap", "Resilient_Neighbors")
final_table %>%
filter(Group %in% R_order) %>%
mutate(Group = factor(Group, levels = R_order)) %>%
ggplot(aes(x = reorder(Feature, Value), y = Value, fill = Group)) +
geom_col(position = "dodge") +
coord_flip() +
labs(title = "Resilient Group")
final_table %>%
filter(Group %in% B_order) %>%
mutate(Group = factor(Group, levels = B_order)) %>%
ggplot(aes(x = reorder(Feature, Value), y = Value, fill = Group)) +
geom_col(position = "dodge") +
coord_flip() +
labs(title = "Broken Group")
B_table <- comparison_table %>%
filter(!Feature %in% l)%>%
mutate(diff_val = abs(Broken - Broken_Neighbors))%>%
arrange(desc(diff_val))%>%
filter(Group %in% B_order) %>%
head(20) %>%
# select(Feature, Broken_Overlap, Resilient_Overlap) %>%
pivot_longer(cols = -Feature, names_to = "Group", values_to = "Value")
final_table %>%
filter(Group %in% B_order) %>%
mutate(Group = factor(Group, levels = B_order)) %>%
ggplot(aes(x = reorder(Feature, Value), y = Value, fill = Group)) +
geom_col(position = "dodge") +
coord_flip() +
labs(title = "Broken Group")
B_table <- comparison_table %>%
filter(!Feature %in% l)%>%
mutate(diff_val = abs(Broken - Broken_Neighbors))%>%
arrange(desc(diff_val))%>%
head(20) %>%
# select(Feature, Broken_Overlap, Resilient_Overlap) %>%
pivot_longer(cols = -Feature, names_to = "Group", values_to = "Value")%>%
filter(Group %in% B_order)
B_table %>%
mutate(Group = factor(Group, levels = B_order)) %>%
ggplot(aes(x = reorder(Feature, Value), y = Value, fill = Group)) +
geom_col(position = "dodge") +
coord_flip() +
labs(title = "Broken Group")
for (i in c(B_order, R_order)) {
B_table <- comparison_table %>%
filter(!Feature %in% l)%>%
mutate(diff_val = abs(Broken - Broken_Neighbors))%>%
arrange(desc(diff_val))%>%
head(20) %>%
# select(Feature, Broken_Overlap, Resilient_Overlap) %>%
pivot_longer(cols = -Feature, names_to = "Group", values_to = "Value")%>%
filter(Group %in% i)
B_table %>%
mutate(Group = factor(Group, levels = B_order)) %>%
ggplot(aes(x = reorder(Feature, Value), y = Value, fill = Group)) +
geom_col(position = "dodge") +
coord_flip() +
labs(title = "Broken Group")
}
for (i in c(B_order, R_order)) {
B_table <- comparison_table %>%
filter(!Feature %in% l)%>%
mutate(diff_val = abs(Broken - Broken_Neighbors))%>%
arrange(desc(diff_val))%>%
head(20) %>%
# select(Feature, Broken_Overlap, Resilient_Overlap) %>%
pivot_longer(cols = -Feature, names_to = "Group", values_to = "Value")%>%
filter(Group %in% i)
plot <- B_table %>%
mutate(Group = factor(Group, levels = B_order)) %>%
ggplot(aes(x = reorder(Feature, Value), y = Value, fill = Group)) +
geom_col(position = "dodge") +
coord_flip() +
labs(title = "Broken Group")
print(plot)
}
B_table %>%
mutate(Group = factor(Group, levels = B_order)) %>%
ggplot(aes(x = reorder(Feature, Value), y = Value, fill = Group)) +
geom_col(position = "dodge") +
coord_flip() +
labs(title = "Broken Group")
B_table
plot
for (i in c(B_order, R_order)) {
B_table <- comparison_table %>%
filter(!Feature %in% l)%>%
mutate(diff_val = abs(Broken - Broken_Neighbors))%>%
arrange(desc(diff_val))%>%
head(20) %>%
# select(Feature, Broken_Overlap, Resilient_Overlap) %>%
pivot_longer(cols = -Feature, names_to = "Group", values_to = "Value")#%>%
# filter(Group %in% i)
plot <- B_table %>%
mutate(Group = factor(Group, levels = B_order)) %>%
ggplot(aes(x = reorder(Feature, Value), y = Value, fill = Group)) +
geom_col(position = "dodge") +
coord_flip() +
labs(title = "Broken Group")
print(plot)
}
for (main_group in target_groups) {
neighbor_group <- paste0(main_group, "_Neighbors")
overlap_group  <- paste0(main_group, "_Overlap")
group_order <- c(main_group, overlap_group, neighbor_group)
plot_data <- comparison_table %>%
filter(!Feature %in% l) %>%
mutate(diff_val = abs(.data[[main_group]] - .data[[neighbor_group]])) %>%
arrange(desc(diff_val)) %>%
head(20) %>%
mutate(Feature = reorder(Feature, diff_val)) %>%
pivot_longer(
cols = -c(Feature, diff_val),
names_to = "Group",
values_to = "Value"
) %>%
filter(Group %in% group_order) %>%
mutate(Group = factor(Group, levels = group_order))
p <- ggplot(plot_data, aes(x = Feature, y = Value, fill = Group)) +
geom_col(position = "dodge", width = 0.7) +
coord_flip() +
labs(title = paste(main_group, "Group Analysis"), y = "Mean Proportion", x = NULL) +
theme_minimal()
print(p)
}
target_groups <- c("Broken", "Resilient")
for (main_group in target_groups) {
neighbor_group <- paste0(main_group, "_Neighbors")
overlap_group  <- paste0(main_group, "_Overlap")
group_order <- c(main_group, overlap_group, neighbor_group)
plot_data <- comparison_table %>%
filter(!Feature %in% l) %>%
mutate(diff_val = abs(.data[[main_group]] - .data[[neighbor_group]])) %>%
arrange(desc(diff_val)) %>%
head(20) %>%
mutate(Feature = reorder(Feature, diff_val)) %>%
pivot_longer(
cols = -c(Feature, diff_val),
names_to = "Group",
values_to = "Value"
) %>%
filter(Group %in% group_order) %>%
mutate(Group = factor(Group, levels = group_order))
p <- ggplot(plot_data, aes(x = Feature, y = Value, fill = Group)) +
geom_col(position = "dodge", width = 0.7) +
coord_flip() +
labs(title = paste(main_group, "Group Analysis"), y = "Mean Proportion", x = NULL) +
theme_minimal()
print(p)
}
for (main_group in target_groups) {
neighbor_group <- paste0(main_group, "_Neighbors")
overlap_group  <- paste0(main_group, "_Overlap")
group_order <- c(main_group, overlap_group, neighbor_group)
plot_data <- comparison_table %>%
filter(!Feature %in% l) %>%
mutate(diff_val = abs(.data[[main_group]] - .data[[neighbor_group]])) %>%
arrange(desc(diff_val)) %>%
head(20) %>%
mutate(Feature = reorder(Feature, diff_val)) %>%
pivot_longer(
cols = -c(Feature, diff_val),
names_to = "Group",
values_to = "Value"
) %>%
filter(Group %in% group_order) %>%
mutate(Group = factor(Group, levels = group_order))
p <- ggplot(plot_data, aes(x = reorder(Feature, Value), y = Value, fill = Group)) +
geom_col(position = "dodge", width = 0.7) +
coord_flip() +
labs(title = paste(main_group, "Group Analysis"), y = "Mean Proportion", x = NULL) +
theme_minimal()
print(p)
}
target_groups <- c("Broken", "Resilient")
all_features_mean <- final_data_for_tree %>%
group_by(Group_Label) %>%
summarise(across(where(is.numeric), \(x) mean(x, na.rm = TRUE))) %>%
ungroup()
all_features_mean$Group_Label%>%unique()
comparison_table <- all_features_mean %>%
pivot_longer(
cols = -Group_Label,
names_to = "Feature",
values_to = "Mean_Value"
) %>%
pivot_wider(
names_from = Group_Label,
values_from = "Mean_Value"
)
for (main_group in c("Broken", "Resilient")) {
neighbor_group <- paste0(main_group, "_Neighbors")
overlap_group  <- paste0(main_group, "_Overlap")
group_order <- c(main_group, overlap_group, neighbor_group)
plot_data <- comparison_table %>%
filter(!Feature %in% l) %>%
mutate(diff_val = abs(.data[[main_group]] - .data[[neighbor_group]])) %>%
arrange(desc(diff_val)) %>%
head(20) %>%
mutate(Feature = reorder(Feature, diff_val)) %>%
pivot_longer(
cols = -c(Feature, diff_val),
names_to = "Group",
values_to = "Value"
) %>%
filter(Group %in% group_order) %>%
mutate(Group = factor(Group, levels = group_order))
p <- ggplot(plot_data, aes(x = reorder(Feature, Value), y = Value, fill = Group)) +
geom_col(position = "dodge", width = 0.7) +
coord_flip() +
labs(title = paste(main_group, "Group Analysis"), y = "Mean Proportion", x = NULL) +
theme_minimal()
print(p)
}
all_features_mean <- final_data_for_tree %>%
group_by(Group_Label) %>%
summarise(across(where(is.numeric), \(x) mean(x, na.rm = TRUE))) %>%
ungroup()
all_features_mean$Group_Label%>%unique()
comparison_table <- all_features_mean %>%
pivot_longer(
cols = -Group_Label,
names_to = "Feature",
values_to = "Mean_Value"
) %>%
pivot_wider(
names_from = Group_Label,
values_from = "Mean_Value"
)
for (main_group in c("Broken", "Resilient")) {
neighbor_group <- paste0(main_group, "_Neighbors")
overlap_group  <- paste0(main_group, "_Overlap")
group_order <- c(main_group, overlap_group, neighbor_group)
plot_data <- comparison_table %>%
filter(!Feature %in% l) %>%
mutate(diff_val = abs(.data[[main_group]] - .data[[neighbor_group]])) %>%
arrange(desc(diff_val)) %>%
head(20) %>%
mutate(Feature = reorder(Feature, diff_val)) %>%
pivot_longer(
cols = -c(Feature, diff_val),
names_to = "Group",
values_to = "Value"
) %>%
filter(Group %in% group_order) %>%
mutate(Group = factor(Group, levels = group_order))
p <- ggplot(plot_data, aes(x = reorder(Feature, Value), y = Value, fill = Group)) +
geom_col(position = "dodge", width = 0.7) +
coord_flip() +
labs(title = paste(main_group, "Group"), y = "Mean Proportion", x = NULL) +
theme_minimal()
print(p)
}
comparison_table
plot_data <- comparison_table %>%
filter(!Feature %in% l, Feature != `Road Edge Line_Not present`) %>%
mutate(diff_val = abs(.data[[main_group]] - .data[[neighbor_group]])) %>%
arrange(desc(diff_val)) %>%
head(20) %>%
mutate(Feature = reorder(Feature, diff_val)) %>%
pivot_longer(
cols = -c(Feature, diff_val),
names_to = "Group",
values_to = "Value")%>%
filter(Group %in% group_order) %>%
mutate(Group = factor(Group, levels = group_order))
all_features_mean <- final_data_for_tree %>%
group_by(Group_Label) %>%
summarise(across(where(is.numeric), \(x) mean(x, na.rm = TRUE))) %>%
ungroup()
all_features_mean$Group_Label%>%unique()
comparison_table <- all_features_mean %>%
pivot_longer(
cols = -Group_Label,
names_to = "Feature",
values_to = "Mean_Value"
) %>%
pivot_wider(
names_from = Group_Label,
values_from = "Mean_Value"
)
for (main_group in c("Broken", "Resilient")) {
neighbor_group <- paste0(main_group, "_Neighbors")
overlap_group  <- paste0(main_group, "_Overlap")
group_order <- c(main_group, overlap_group, neighbor_group)
plot_data <- comparison_table %>%
filter(!Feature %in% l, Feature != `Road Edge Line_present`) %>%
mutate(diff_val = abs(.data[[main_group]] - .data[[neighbor_group]])) %>%
arrange(desc(diff_val)) %>%
head(20) %>%
mutate(Feature = reorder(Feature, diff_val)) %>%
pivot_longer(
cols = -c(Feature, diff_val),
names_to = "Group",
values_to = "Value")%>%
filter(Group %in% group_order) %>%
mutate(Group = factor(Group, levels = group_order))
p <- ggplot(plot_data, aes(x = reorder(Feature, Value), y = Value, fill = Group)) +
geom_col(position = "dodge", width = 0.7) +
coord_flip() +
labs(title = paste(main_group, "Group"), y = "Mean Proportion", x = NULL) +
theme_minimal()
print(p)
}
all_features_mean <- final_data_for_tree %>%
group_by(Group_Label) %>%
summarise(across(where(is.numeric), \(x) mean(x, na.rm = TRUE))) %>%
ungroup()
all_features_mean$Group_Label%>%unique()
comparison_table <- all_features_mean %>%
pivot_longer(
cols = -Group_Label,
names_to = "Feature",
values_to = "Mean_Value"
) %>%
pivot_wider(
names_from = Group_Label,
values_from = "Mean_Value"
)
for (main_group in c("Broken", "Resilient")) {
neighbor_group <- paste0(main_group, "_Neighbors")
overlap_group  <- paste0(main_group, "_Overlap")
group_order <- c(main_group, overlap_group, neighbor_group)
plot_data <- comparison_table %>%
filter(!Feature %in% l, Feature != 'Road Edge Line_present') %>%
mutate(diff_val = abs(.data[[main_group]] - .data[[neighbor_group]])) %>%
arrange(desc(diff_val)) %>%
head(20) %>%
mutate(Feature = reorder(Feature, diff_val)) %>%
pivot_longer(
cols = -c(Feature, diff_val),
names_to = "Group",
values_to = "Value")%>%
filter(Group %in% group_order) %>%
mutate(Group = factor(Group, levels = group_order))
p <- ggplot(plot_data, aes(x = reorder(Feature, Value), y = Value, fill = Group)) +
geom_col(position = "dodge", width = 0.7) +
coord_flip() +
labs(title = paste(main_group, "Group"), y = "Mean Proportion", x = NULL) +
theme_minimal()
print(p)
}
comparison_table$Feature
comparison_table%>%
filter(Feature != `Road Edge Line_Not present`)
comparison_table$Feature>%%unique()
comparison_table$Feature%>%unique()
comparison_table%>%
filter(Feature != "Road Edge Line_Not present")
comparison_table
all_features_mean <- final_data_for_tree %>%
group_by(Group_Label) %>%
summarise(across(where(is.numeric), \(x) mean(x, na.rm = TRUE))) %>%
ungroup()
all_features_mean$Group_Label%>%unique()
comparison_table <- all_features_mean %>%
pivot_longer(
cols = -Group_Label,
names_to = "Feature",
values_to = "Mean_Value"
) %>%
pivot_wider(
names_from = Group_Label,
values_from = "Mean_Value"
)
for (main_group in c("Broken", "Resilient")) {
neighbor_group <- paste0(main_group, "_Neighbors")
overlap_group  <- paste0(main_group, "_Overlap")
group_order <- c(main_group, overlap_group, neighbor_group)
plot_data <- comparison_table %>%
filter(!Feature %in% l, Feature != 'Road Edge Line_present') %>%
mutate(diff_val = abs(.data[[main_group]] - .data[[neighbor_group]])) %>%
arrange(desc(diff_val)) %>%
head(20) %>%
mutate(Feature = reorder(Feature, diff_val)) %>%
pivot_longer(
cols = -c(Feature, diff_val),
names_to = "Group",
values_to = "Value")%>%
filter(Group %in% group_order) %>%
mutate(Group = factor(Group, levels = group_order))
p <- ggplot(plot_data, aes(x = reorder(Feature, Value), y = Value, fill = Group)) +
geom_col(position = "dodge", width = 0.7) +
coord_flip() +
labs(title = paste(main_group, "Group"), y = "Mean Proportion", x = NULL) +
theme_minimal()
print(p)
}
all_features_mean <- final_data_for_tree %>%
group_by(Group_Label) %>%
summarise(across(where(is.numeric), \(x) mean(x, na.rm = TRUE))) %>%
ungroup()
all_features_mean$Group_Label%>%unique()
comparison_table <- all_features_mean %>%
pivot_longer(
cols = -Group_Label,
names_to = "Feature",
values_to = "Mean_Value"
) %>%
pivot_wider(
names_from = Group_Label,
values_from = "Mean_Value"
)
for (main_group in c("Broken", "Resilient")) {
neighbor_group <- paste0(main_group, "_Neighbors")
overlap_group  <- paste0(main_group, "_Overlap")
group_order <- c(main_group, overlap_group, neighbor_group)
plot_data <- comparison_table %>%
filter(!Feature %in% l, Feature != 'Road Edge Line_Present') %>%
mutate(diff_val = abs(.data[[main_group]] - .data[[neighbor_group]])) %>%
arrange(desc(diff_val)) %>%
head(20) %>%
mutate(Feature = reorder(Feature, diff_val)) %>%
pivot_longer(
cols = -c(Feature, diff_val),
names_to = "Group",
values_to = "Value")%>%
filter(Group %in% group_order) %>%
mutate(Group = factor(Group, levels = group_order))
p <- ggplot(plot_data, aes(x = reorder(Feature, Value), y = Value, fill = Group)) +
geom_col(position = "dodge", width = 0.7) +
coord_flip() +
labs(title = paste(main_group, "Group"), y = "Mean Proportion", x = NULL) +
theme_minimal()
print(p)
}
